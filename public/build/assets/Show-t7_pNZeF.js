import{r as i,v as m,j as r,$ as u,m as p}from"./app-Be8ghtRb.js";import{A as x}from"./app-layout-BXVEw3EX.js";import{F as j,a as f}from"./index-BQC2eOyb.js";import{C as h,a as g,b as _,d as S,c as b}from"./card-B8jOSnGI.js";import{t as n}from"./index-CuSu5bUe.js";import{A as y,a as v}from"./alert-B2RiZxSE.js";import"./button-D1N9RrD0.js";import"./index-wGWY3QV4.js";import"./index-BQmSkEsW.js";import"./index-CCmhZsir.js";import"./index-Bvxqhwof.js";import"./app-logo-icon-Dxd9VO9-.js";import"./input-Co6CCOt6.js";import"./label-DPNJkhla.js";import"./textarea-B1dCnzMh.js";import"./select-B4H269ix.js";import"./index-C7CVg9dv.js";import"./checkbox-DjBb_Stx.js";import"./es-D51pjrp8.js";import"./save-D8X6UB3U.js";const q=({formulario:e})=>{const o=i.useMemo(()=>{if(typeof e.form_estructura_json=="string"&&e.form_estructura_json)try{const s=JSON.parse(e.form_estructura_json);return Array.isArray(s)?s:(console.error("Parsed form_estructura_json is not an array:",s),[])}catch(s){return console.error("Error parsing form_estructura_json:",s),[]}return Array.isArray(e.form_estructura_json)?e.form_estructura_json:[]},[e.form_estructura_json]),{processing:c,errors:t}=m({}),d=async s=>{console.log("Datos recibidos de FormRenderer (formDataFromRenderer):",s),console.log("JSON Stringified (antes de Inertia.post):",JSON.stringify(s)),p.post(route("formularios.submit",{form:e.id}),{content:s},{onSuccess:()=>{n({title:"Formulario enviado",description:"Los datos del formulario se han guardado exitosamente."})},onError:a=>{console.error("Errores de Inertia:",a),n({title:"Error al enviar",description:"Hubo un problema al guardar el formulario. Revisa los errores.",variant:"destructive"})}})};i.useEffect(()=>{console.log("Prop formulario en Show.tsx:",e),console.log("form_estructura_json original en Show.tsx:",e.form_estructura_json),console.log("parsedFormStructure en Show.tsx:",o),console.log("Tipo de parsedFormStructure:",typeof o,Array.isArray(o))},[e,o]);const l=async s=>{console.log("Guardando borrador:",s),n({title:"Borrador guardado",description:"La funcionalidad de guardar borrador está pendiente de implementación en el backend."})};return r.jsxs(x,{children:[r.jsx(u,{title:`Responder: ${e.nombre}`}),r.jsx("div",{className:"py-12",children:r.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:r.jsxs(h,{children:[r.jsxs(g,{children:[r.jsx(_,{children:e.nombre}),r.jsxs(S,{children:["Identificador: ",e.identificador]})]}),r.jsxs(b,{children:[o&&o.length>0?r.jsx(j,{formStructure:o,onSubmit:d,onSave:l,isSubmitting:c}):r.jsx("p",{className:"text-center text-muted-foreground",children:"Este formulario no tiene una estructura definida."}),t&&Object.keys(t).length>0&&r.jsxs(y,{variant:"destructive",className:"mt-4",children:[r.jsx(f,{className:"h-4 w-4"}),r.jsxs(v,{children:["Hubo errores al enviar el formulario:",r.jsx("ul",{className:"list-disc pl-5 mt-2",children:Object.values(t).map((s,a)=>r.jsx("li",{children:s},a))})]})]})]})]})})})]})};export{q as default};
